<!DOCTYPE html> 
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>InvitaciÃ³n â€“ David & Selena</title>
  <meta name="description" content="InvitaciÃ³n interactiva con audio y enlaces" />
  <style>
    :root{ 
      --max-width: 840px;
      --vino:#7b0d1e;      /* granate */
      --dorado:#c9a24e;    /* dorado suave */
      --negro:#2b2b2b;     /* negro cÃ¡lido */
      --marco: rgba(201,162,78,.35);
    }
    *{box-sizing:border-box}
    html,body{margin:0;background:#0b0b0b;color:#111;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}

    /* Lienzo vertical responsive */
    .stage{position:relative;width:min(100vw,var(--max-width));margin:16px auto;border-radius:20px;overflow:hidden;box-shadow:0 10px 30px rgba(0,0,0,.35);background:#000}
    .bg{display:block;width:100%;height:auto}

    /* Hotspots encima del arte */
    .hotspot{position:absolute;display:inline-block}
    .hotspot a{display:block;width:100%;height:100%;text-indent:-9999px;overflow:hidden}

    /* Controles de mÃºsica */
    .controls{position:absolute;left:50%;top:10%;transform:translateX(-50%);display:flex;gap:8px;align-items:center;background:rgba(255,255,255,.92);border-radius:999px;padding:10px 14px;box-shadow:0 8px 24px rgba(0,0,0,.25);display:none}
    .btn{border:0;border-radius:999px;padding:8px 12px;cursor:pointer;background:#fff;font-weight:600}
    .btn:focus{outline:3px solid #4c9ffe;outline-offset:2px}

    /* Hotspots de interacciÃ³n */
    #hs-music { left:70%; top:13.4%; width:7.1%; height:1%; }
    #hs-cal   { left:13.9%; top:33.4%; width:28%; height:1.1%; }
    #hs-map   { left:53%;   top:38.7%;   width:25%; height:1%; }
    #hs-form  { left:57%;   top:47.7%;   width:25%; height:1.1%; }

    /* === Nuevo Contador === */
    .cd-wrap{
      position:absolute; left:20%; top:95%; width:60%;
      display:flex; flex-direction:column; align-items:center; gap:.6rem;
      margin:.75rem auto 0;
    }
    .countdown{
      display:flex; gap:.5rem; width:100%; justify-content:center; align-items:stretch;
    }
    .cd-box{
      flex:1; min-width:80px; text-align:center; padding:.75rem .5rem;
      border:1px solid var(--marco); border-radius:16px; background:#fff;
      box-shadow:0 4px 14px rgba(0,0,0,.04);
    }
    .cd-num{
      display:block; font-size:2rem; line-height:1; font-weight:700; color:var(--vino);
      font-variant-numeric:tabular-nums;
    }
    .cd-label{
      display:block; margin-top:.25rem; letter-spacing:.04em; text-transform:uppercase;
      font-size:.72rem; color:var(--negro); opacity:.8;
    }
    .cd-note{
      font-size:.85rem; color:var(--negro); opacity:.7; text-align:center;
    }
    .cd-sep{
      align-self:stretch; width:1px; background:linear-gradient(to bottom, transparent, var(--marco), transparent);
    }
    @media (max-width: 420px){
      .countdown{gap:.35rem}
      .cd-box{min-width:0; padding:.65rem .4rem}
      .cd-num{font-size:1.7rem}
    }
    .cd-done{
      border-color:var(--dorado);
      box-shadow:0 6px 20px rgba(201,162,78,.25);
    }
  </style>
</head>
<body>
  <main class="stage" aria-label="InvitaciÃ³n interactiva">
    <!-- Fondo -->
    <img class="bg" src="assets/Boda.jpg" alt="InvitaciÃ³n David y Selena" id="bg"/>

    <!-- MÃºsica -->
    <video id="media" preload="metadata" playsinline style="position:absolute;left:-9999px;width:1px;height:1px;opacity:0;" aria-hidden="true">
      <source src="assets/musica.mp4" type="video/mp4"/>
      Tu navegador no soporta vÃ­deo HTML5.
    </video>
    <div class="controls" id="controls">
      <button class="btn" id="play">â–¶ï¸Ž Reproducir</button>
      <button class="btn" id="mute">ðŸ”Š</button>
    </div>

    <!-- Hotspots -->
    <div id="hs-music" class="hotspot"><a href="#" onclick="toggleMusic(); return false;" aria-label="Reproducir/Pausar mÃºsica">Reproducir mÃºsica</a></div>
    <div id="hs-cal" class="hotspot"><a href="https://calendar.app.google/L6ciMkGSfXdSb6ju7" target="_blank" rel="noopener">Agenda la fecha</a></div>
    <div id="hs-map" class="hotspot"><a href="https://maps.app.goo.gl/P5i7W7WSzFhvjFDs9" target="_blank" rel="noopener">Ver mapa</a></div>
    <div id="hs-form" class="hotspot"><a href="https://docs.google.com/forms/d/e/1FAIpQLSdmN66lbqBq6saBTdLBhs7DRX55u6N_YkGAtVkXV1Ysww89ZQ/viewform?usp=header" target="_blank" rel="noopener">Confirmar asistencia</a></div>

    <!-- === Nuevo Contador === -->
    <div class="cd-wrap" aria-live="polite">
      <div class="countdown" id="countdown">
        <div class="cd-box" aria-label="Meses restantes">
          <span class="cd-num" id="cd-months">0</span>
          <span class="cd-label">Meses</span>
        </div>
        <div class="cd-sep"></div>
        <div class="cd-box" aria-label="DÃ­as restantes">
          <span class="cd-num" id="cd-days">0</span>
          <span class="cd-label">DÃ­as</span>
        </div>
        <div class="cd-sep"></div>
        <div class="cd-box" aria-label="Horas restantes">
          <span class="cd-num" id="cd-hours">0</span>
          <span class="cd-label">Horas</span>
        </div>
      </div>
      <div class="cd-note" id="cd-note">Hasta el 29 de noviembre Â· 17:00 h</div>
    </div>
  </main>

  <script>
    const media = document.getElementById('media');
    const playBtn = document.getElementById('play');
    const muteBtn = document.getElementById('mute');

    function ensureUnmutedOnFirstPlay(){
      if (media.muted) media.muted = false;
    }
    function toggleMusic(){
      ensureUnmutedOnFirstPlay();
      if(media.paused){ media.play().catch(e=>console.warn('No se pudo reproducir:', e)); }
      else{ media.pause(); }
    }
    if(playBtn && muteBtn){
      playBtn.addEventListener('click', async () => {
        try{
          ensureUnmutedOnFirstPlay();
          if (media.paused){ await media.play(); playBtn.textContent='â¸ï¸Ž Pausar'; }
          else{ media.pause(); playBtn.textContent='â–¶ï¸Ž Reproducir'; }
        }catch(e){ console.warn('No se pudo reproducir:', e); }
      });
      muteBtn.addEventListener('click', () => {
        media.muted = !media.muted;
        muteBtn.textContent = media.muted ? 'ðŸ”‡' : 'ðŸ”Š';
      });
    }

    // === LÃ³gica nuevo contador ===
    (function(){
      const target = new Date('2025-11-29T17:00:00+01:00');
      const elM = document.getElementById('cd-months');
      const elD = document.getElementById('cd-days');
      const elH = document.getElementById('cd-hours');
      const wrap = document.getElementById('countdown');
      const note = document.getElementById('cd-note');

      function addMonths(date, months){
        const d = new Date(date);
        const day = d.getDate();
        d.setDate(1);
        d.setMonth(d.getMonth() + months);
        const lastDay = new Date(d.getFullYear(), d.getMonth()+1, 0).getDate();
        d.setDate(Math.min(day, lastDay));
        return d;
      }
      function diffParts(now, tgt){
        if (now >= tgt) return {months:0, days:0, hours:0, done:true};
        let months = (tgt.getFullYear() - now.getFullYear()) * 12 + (tgt.getMonth() - now.getMonth());
        const candidate = addMonths(now, months);
        if (candidate > tgt) { months -= 1; }
        const afterMonths = addMonths(now, months);
        let ms = tgt - afterMonths;
        const dayMs = 24*60*60*1000;
        const hourMs = 60*60*1000;
        const days = Math.floor(ms / dayMs);
        ms -= days * dayMs;
        const hours = Math.floor(ms / hourMs);
        return {months, days, hours, done:false};
      }
      function render(){
        const now = new Date();
        const {months, days, hours, done} = diffParts(now, target);
        if (done){
          elM.textContent = '0';
          elD.textContent = '0';
          elH.textContent = '0';
          wrap.classList.add('cd-done');
          note.textContent = 'Â¡LlegÃ³ el gran dÃ­a!';
          return true;
        } else {
          elM.textContent = String(months);
          elD.textContent = String(days);
          elH.textContent = String(hours);
          return false;
        }
      }
      let finished = render();
      if (!finished){
        const timer = setInterval(()=>{
          if (render()){ clearInterval(timer); }
        }, 60000); // actualiza cada minuto
      }
    })();
  </script>
</body>
</html>
